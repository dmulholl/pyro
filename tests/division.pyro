import std::constants::{i64_min};

# Floating-point division.
assert 10 / 5 == 2.0;
assert 10 / 5.0 == 2.0;
assert 10.0 / 5 == 2.0;
assert 10.0 / 5.0 == 2.0;

assert 11 / 5 == 2.2;
assert 11 / 5.0 == 2.2;
assert 11.0 / 5 == 2.2;
assert 11.0 / 5.0 == 2.2;

assert $is_err(try (1 / 0));
assert $is_err(try (1 / 0.0));
assert $is_err(try (1.0 / 0));
assert $is_err(try (1.0 / 0.0));

assert !$is_err(try (i64_min / -1));

# Truncated division.
assert 10 // 5 == 2;
assert 10 // 5.0 == 2.0;
assert 10.0 // 5 == 2.0;
assert 10.0 // 5.0 == 2.0;

assert 11 // 5 == 2;
assert 11 // 5.0 == 2.0;
assert 11.0 // 5 == 2.0;
assert 11.0 // 5.0 == 2.0;

assert $is_err(try (1 // 0));
assert $is_err(try (1 // 0.0));
assert $is_err(try (1.0 // 0));
assert $is_err(try (1.0 // 0.0));

assert $is_err(try (i64_min // -1));

assert 5 // 3 == 1;
assert 5 // -3 == -1;
assert -5 // 3 == -1;
assert -5 // -3 == 1;

# The // operator rounds toward zero.
assert -1 // 10 == 0;
assert -10 // 3 == -3;

# Remainder operator.
assert 0 % 1 == 0;
assert 1 % 1 == 0;
assert 2 % 1 == 0;
assert 3 % 1 == 0;
assert 4 % 1 == 0;

assert 0 % 2 == 0;
assert 1 % 2 == 1;
assert 2 % 2 == 0;
assert 3 % 2 == 1;
assert 4 % 2 == 0;

assert 0 % 3 == 0;
assert 1 % 3 == 1;
assert 2 % 3 == 2;
assert 3 % 3 == 0;
assert 4 % 3 == 1;
assert 5 % 3 == 2;
assert 6 % 3 == 0;

assert 2.25 % 2.0 == 0.25;
assert 2.25 % 2 == 0.25;
assert 2 % 0.5 == 0.0;

assert $is_err(try (5 % 0));

with (numerator, denominator) = (5, 3) {
    let quotient = numerator // denominator;
    let remainder = numerator % denominator;

    assert quotient == 1;
    assert remainder == 2;
    assert quotient * denominator + remainder == numerator;
}

with (numerator, denominator) = (5, -3) {
    let quotient = numerator // denominator;
    let remainder = numerator % denominator;

    assert quotient == -1;
    assert remainder == 2;
    assert quotient * denominator + remainder == numerator;
}

with (numerator, denominator) = (-5, 3) {
    let quotient = numerator // denominator;
    let remainder = numerator % denominator;

    assert quotient == -1;
    assert remainder == -2;
    assert quotient * denominator + remainder == numerator;
}

with (numerator, denominator) = (-5, -3) {
    let quotient = numerator // denominator;
    let remainder = numerator % denominator;

    assert quotient == 1;
    assert remainder == -2;
    assert quotient * denominator + remainder == numerator;
}

with (numerator, denominator) = (-1, 10) {
    let quotient = numerator // denominator;
    let remainder = numerator % denominator;

    assert quotient == 0;
    assert remainder == -1;
    assert quotient * denominator + remainder == numerator;
}

loop var numerator = -10; numerator <= 10; numerator += 1 {
    loop var denominator = -3; denominator <= 3; denominator += 1 {
        if denominator == 0 {
            continue;
        }

        let quotient = numerator // denominator;
        let remainder = numerator % denominator;

        assert quotient * denominator + remainder == numerator;
    }
}
